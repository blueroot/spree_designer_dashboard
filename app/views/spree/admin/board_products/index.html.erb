<link href="//netdna.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap.min.css" rel="stylesheet">
<script src="//netdna.bootstrapcdn.com/bootstrap/3.1.1/js/bootstrap.min.js"></script>

<%= render :partial => 'spree/admin/shared/boards_sub_menu' %>

<% content_for :page_title do %>
  <%= Spree.t(:products_on_boards) %>
<% end %>


<% @board_products.each do |board_product| %>
  
  <% if board_product.product %>
    <% shipping_dimensions = "#{board_product.product.master.shipping_height}x#{board_product.product.master.shipping_width}x#{board_product.product.master.shipping_depth}" %>
    <% shipping_dimensions = (shipping_dimensions == "xx") ? "0x0x0" : shipping_dimensions %>

    <div class = "search-result row index ">

      <div class="actions col-md-1 tile-contents" >

        <div>
          <a data-toggle ="tooltip" data-placement = "right" title = "Approve item for board" class = "ok" href = "#<%= board_product.id %>">
            <span class="glyphicon glyphicon-ok glyphicon-ok-<%= board_product.id %>"></span>
          </a>
        </div>

        <br/>
        <br/>

        <div>
          <a data-toggle ="tooltip" data-placement = "right" title = "Remove item from board" class = "remove" href = "#<%= board_product.id %>">
            <span class="glyphicon glyphicon-remove"></span>
          </a>
        </div>

        <br/>
        <br/>
        <div>
          <a data-toggle ="tooltip" data-placement = "right" title = "Save board information" class = "save" href = "#<%= board_product.id %>">
            <span class="glyphicon glyphicon-floppy-disk"></span><br/>
          </a>
        </div>

      </div>

      <div class = "col-md-2">
        <%= small_image(board_product.product, class: "img-thumbnail") %>
      </div>

      <div class = "col-md-7 product-details tile-contents">

        <div class = "row">
          <div class = "col-md-3"><b>Name:</b><br/><%= text_field_tag "product_#{board_product.product.id}_name", board_product.product.name, placeholder: "Name" %></div>
          <div class = "col-md-3"><b>SKU:</b><br/> <%= text_field_tag "product_#{board_product.product.id}_sku", board_product.product.sku  %></div>
          <div class = "col-md-3"><b>Dimensions:</b><br/> <%= text_field_tag "product_#{board_product.product.id}_dimensions", shipping_dimensions %></div>
          <div class = "col-md-3"><b>Inventory:</b> <br/><%= text_field_tag "product_#{board_product.product.id}_inventory", "10" %></div>
        </div>

        <div class = "row">
          <div class = "col-md-3"><b>MSRP:</b> <br/><%= text_field_tag "product_#{board_product.product.id}_msrp", board_product.product.price %></div>
          <div class = "col-md-3"><b>Price:</b> <br/><%= text_field_tag "product_#{board_product.product.id}_price", board_product.product.price %></div>
          <div class = "col-md-3"><b>Cost:</b> <br/><%= text_field_tag "product_#{board_product.product.id}_cost", board_product.product.name, placeholder: "Name" %></div>
          <div class = "col-md-3"><b>MAP:</b> <br/><%= text_field_tag "product_#{board_product.product.id}_map", board_product.product.price %></div>
        </div>

      </div>

      <div class = "col-md-2 img-thumbnail tile-contents board-image">
        <%= board_image(board_product.board, :small) %>
      </div>

    </div>
  <% end %>
<% end %>

<script>

$(".ok").tooltip();
$(".remove").tooltip();
$(".save").tooltip();

$(".sixteen").removeClass("sixteen")

$(".glyphicon-ok").click(function(e){
    split_url = document.URL.split("#");
    alert("approving " + split_url[1]);
});

$(".glyphicon-remove").click(function(e){
    split_url = document.URL.split("#");
    alert("removing " + split_url[1]);
});

$(".glyphicon-floppy-disk").click(function(e){
    split_url = document.URL.split("#");
    alert("saving the changes to " + split_url[1]);
});

$(".columns").removeClass("columns")

  $(".save-product-button").click(function(e){

      board_product_id = split_url[1];
      product_id = split_url[2];
      board_id = split_url[3];

      // here we'll need to make a couple posts
      // so far i know we'll need to post to products and board_products
      // maybe variants and shipping options too?
      new_product_name = $("#product_"+product_id+"_name").val();
      new_product_price = $("#product_"+product_id+"_price").val();

      new_product = {
        name: new_product_name,
        price: new_product_price
      };

      new_board_name = $("#board_"+board_id+"_name").val();

      new_board = {
        name: new_board_name
      };

      alert(JSON.stringify(new_product));
      alert(JSON.stringify(new_board));
      alert("Looking into routes to post these to...");

//      $("#board_product_"+board_product_id).show();
//      $("#editing_"+board_product_id).hide();
  });

</script>

<%= paginate @board_products %>
