<div class="container">
	<div class="page-header clearfix">
		<h1>Find Products and add them to your Board</h1>
	</div>
		<div class="board-product-search">
			<%= form_tag("/boards/product_search", method: "get", :id => "product_search_form") do %>
				<table cellspacing="0" cellpadding="0" border="0">
					<tr>
						<th>Search by name</th>
						<th colspan="3">Filter</th>
					</tr>
					<tr>
						<td><input type="text" id="product_keywords" name="product_keywords"></td>
						<td><%= select_tag "taxon", options_from_collection_for_select(@department_taxons, "id", "name"), :include_blank => true %></td>
						<td><%= submit_tag("Search")%></td>
						<td class="pagination"><div id="select-products-pagination"></div></td>
					</tr>
				</table>
			<% end %>
		</div>
		<div id="board-container">
		<div id="select-products-box" class="select-products-box" style="border: 1px solid #aaa; height: 220px; width: 920px; margin-bottom: 20px; padding: 10px 0; overflow-y:hidden; overflow-x: scroll;">
			
				
		</div>
		
		<label>Your Canvas</label>
		<div id="board-canvas" data-board-id="<%= @board.id %>" style="height: 400px; width: 700px; background-color: #fff; border: 1px dashed #bdc3c7; position: relative; z-index: 1; margin-bottom: 30px;"></div>
		</div>
		
	
</div>
<style>
	.board-product-selected{
		border: 2px solid #aaa;
		margin: -2px 0 0 -2px;
	}
	.light-box-product-unavailable{
		border: 1px solid red;
	}
</style>

<script>


$(function () {
    var element;
    
    $('#board-canvas').droppable({
        accept: function(element) {
		  var cn = element.className;
		  return cn == 'board-lightbox-product' || 'board-lightbox-product-cloned'
		},
        drop: handleDropEvent
    });
	getSavedProducts($('#board-canvas').data('boardId'));
	
	
	/* attach a submit handler to the form */
	$("#product_search_form").submit(function(event) {

		/* stop form from submitting normally */
		event.preventDefault();

		/* get some values from elements on the page: */
		var $form = $( this ),
		term = $form.find( 'input[name="product_keywords"]' ).val(),
		taxon = $form.find( 'select[name="taxon"]' ).val(),
		url = $form.attr( 'action' );
		
		//alert(taxon);
		/* Send the data using post */
		var posting = $.post( url, { keywords: term, taxon_id: taxon } );

		/* Put the results in a div */
		posting.done(function( data ) {
			//var content = $( data ).find( '#content' );
			//$( "#result" ).empty().append( content );
		});
	});
	
});
</script>
