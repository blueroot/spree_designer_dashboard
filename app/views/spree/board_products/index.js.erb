$('#board-canvas').html('<%= escape_javascript(raw render(:partial => "products", :locals => {:board_products => @board_products})) %>')


$('.board-lightbox-product-cloned').each(function() {
	handleDragAfterDrop($(this));
	handleResizable($(this));
	handleSelectable($(this));
	handleRemoveFromCanvas($(this));
	handleProductPopover($(this));
	handleProductHoverable($(this));
});

$("#bp-rotate-left").click(function() {
	el = $('.board-product-selected').first();
	var offset_val = el.data('rotationOffset');
	var new_offset_val = el.data('rotationOffset') + 90;
	el.rotate({ animateTo:new_offset_val,callback: function(){   alert(1)  }});
	el.data('rotationOffset',new_offset_val);
	
});


$('body').on('click', function (e) {
    $('.board-lightbox-product-cloned').each(function () {
        //the 'is' for buttons that trigger popups
        //the 'has' for icons within a button that triggers a popup
        if (!$(this).is(e.target) && $(this).has(e.target).length === 0 && $('.popover').has(e.target).length === 0) {
            $(this).popover('hide');
        }
    });
});